## AutoWork - 自动办公脚本系统设计与实现
AutoWork 是一个基于 Python 开发的自动办公脚本系统，结合 OCR 图文识别、图像匹配与用户输入输出控制，配合类似 Excel 表格的脚本语法，实现了高度灵活、可编程的自动操作能力，已在实际工作中投入使用。

### 项目背景与目标
项目起源于一个简单的需求：“让电脑自动替人完成一些重复性的操作”。为此，作者设计了一套结合文字识别、图像识别与模拟操作的脚本执行系统，并提出了“Excel 语言编程”的理念，用表格写代码，无需传统的代码编辑器即可编写逻辑。

### 核心功能模块

#### 1. 文本与图像定位
- **find_text**：基于 EasyOCR，识别屏幕或图片中的文字，返回目标文本的像素位置
- **find_image**：基于 OpenCV，识别屏幕或图片中的图片区域，返回目标图片的像素位置

#### 2. Excel 脚本驱动机制
每条自动化指令使用一行 Excel 表格描述，包含以下四列字段：

| 时间   | 事件 | 细节 | 条件 |
| ------ | ---- | ---- | ---- |
| 可省略 | 执行的动作，例如鼠标单击、查找文字、输入文本等 | 指令参数，如“左键”、“变量名”或“要输入的文本” | 部分指令需填写，如点击位置、判断目标等 |

系统默认以 0.1 秒间隔执行每条指令，支持丰富的交互行为。

#### 3. 鼠标与键盘控制
- 支持鼠标点击、双击、移动至指定文字或图像位置
- 支持剪贴板输入与模拟键盘输入

#### 4. 控制结构：循环与判断
- 嵌套循环结构使用栈实现，支持循环次数控制
- 支持 continue（继续）和 break（退出）
- 判断语句可检测屏幕区域中是否存在指定文字或图片

#### 5. 文件与数据处理
- 支持文件的移动、复制、删除
- 支持 Excel 写入和 txt 文本写入

#### 6. 变量与表达式
- 支持整数、小数、字符串变量的定义与修改
- 变量可参与计算、拼接与条件判断
- 变量可用于指定查找区域、文本内容和输出目标

#### 7. 等待与超时机制
- 支持“等待某图片/文字出现”后再执行下一步
- 避免因系统响应慢而导致指令失败
- 设置最大等待时间，超时后跳过或执行替代操作

### 实际应用场景
该系统已被实际部署，用于日常办公中重复性、规则性强的任务，如批量文件处理、系统登录操作、报表生成等。通过灵活的脚本描述与视觉定位能力，用户无需编程背景即可构建高效自动化流程。

### 后续优化方向
- 图形化脚本编辑器
- 任务调度器和日志记录系统
- 更多图像识别模型适配（如中文字高精度识别）

### License
本项目用于学习与办公自动化研究，欢迎探索与反馈，禁止商业用途。
